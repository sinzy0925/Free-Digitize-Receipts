# Free-Digitize-Receipts
領収書を無料でデジタル化しよう！

この作業をするとこうなります。
https://www.youtube.com/watch?v=jHZQY51nyFY

<aside>
💡 領収書が、大量に溜まっていて、確定申告や経費精算などでお困りではないですか？　そんなあなたに、無料ツールのご提案です。環境構築が少し面倒ですが、環境さえできれば、無料で使い放題です。

</aside>

# 👀 問題

> **紙の領収書が大量にある：**
> 
- 大量の領収書を手作業で集計している人向けに、AIで自動的に集計します。
- 動画を見ながらAIの環境を構築してください。
- もっと簡単な方法があるかもしれませんのであれば教えてください。
- 非効率な作業とはお別れしましょう！

---

# 💭 提案

> **Dify、Googleドライブ、スプレッドシート、GASを使って簡単に集計します：**
> 
- Difyは、無料で使えるAIプラットフォームです。今回は、領収書の文字起こしをして、必要な項目を取得できるように作成済です。ブロックを組み立てる要領で作成します。　ブロックは作成済です。（初心者が使えるように動画を公開済です。下記の**準備１：Difyが動くように準備しよう（６ステップ）参照**）
- Googleドライブには、領収書を画像化して保管します。例えば、image_fileなどのフォルダを作成して、領収書を保管します。そのフォルダはGASからアクセスできるように、共有設定をしておきます。
- スプレッドシートには、Googleドライブの情報と、Difyで取得した領収書の内容を書き込みます。ボタンをクリックすると、必要な作業を自動で行います。
- GAS (Google Apps Script)は、上記３種類のツールを連携して動くようにするためのアプリケーションプログラムです。既に作成済です。理解する必要はありません。（上記スプレッドシートのボタンに組み込んであります。）理解したい人は、GASのコードを見ることもできます。
- システム構成図はこんな感じです。

![スクリーンショット 2024-12-16 222648.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/94739130-ba6a-488c-829a-2fbe2e8866b5/fbb651a1-a32a-4c3c-a671-e724f1135d22/%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88_2024-12-16_222648.png)

---

# 🛫 ツールの準備をして使っていこう！

> **ツールの準備：**
> 
- ツールの準備は少し面倒です。その面倒を乗り越えるとボタンを２回クリックするだけで領収書が自動集計されます

- **準備１：Difyが動くように準備しよう（６ステップ）**
    - [ ]  **ステップ０：Difyのアプリダウンロード**
        
        動画：https://youtu.be/EWtQfxDlPhE
        
        アプリ：https://drive.google.com/file/d/1JPRhIucpKmjfL79-zJzA2JLHPPLWd-sH/view?usp=drive_link
        
        領収書データ：https://drive.google.com/file/d/1BY4t39wxDeknr9xoUhRW2NIGwft2r6Br/view?usp=sharing
        
    - [ ]  **ステップ１：Difyにログイン(Gmailでログイン)**
        
        動画：https://youtu.be/wJjy12geues
        
    - [ ]  **ステップ２：Difyにログイン(Gmail以外でログイン)**
        
        動画：https://youtu.be/oLWh77yhfDU　
        
    - [ ]  **ステップ３：DifyのLLM(大規模言語モデル)を使う準備します（LLMのAPIキーの取得もあります）**
        
        動画：https://youtu.be/ZwbvHsXoCxo
        
    - [ ]  **ステップ４：ステップ０でダウンロードしたアプリを活用します**
        
        動画：https://youtu.be/NVX_eHZ6zFI
        
    - [ ]  **ステップ５：Difyを公開してAPIキーを取得し、GASと連携する準備をします**
        
        動画：https://youtu.be/XKmXmA3Z4BY
        
- **準備２：GASが動くように準備しよう（動画見て下さい）**
    
    以下の内容を説明しているYoutube動画はこちら
    
    https://www.youtube.com/watch?v=vBkkDiV5No0
    
    - [ ]  ＳＴＥＰ１：以下のスプレッドシートURLを自分のブラウザに貼り付けます
        
        URL：https://docs.google.com/spreadsheets/d/1x257I5x45m4vh2q8SmPr9MULoCCMgmcm6UdFgpo9Cvg/edit?usp=sharing
        
    - [ ]  ＳＴＥＰ２：スプレッドシートが表示されたら、
        
        ファイルメニューから「コピーを作成」をクリックします。
        
        URLが変わっていることを確認します。
        
        コピー後のURLがあなたのスプレッドシートです
        
        上記のコピー元のスプシを消します。
        
    - [ ]  ＳＴＥＰ３：ＥＮＶシートのＣ２～Ｃ５を入力します
        
        **セルＣ２**：今開いているあなたのスプシのURLをコピーして、貼り付けます
        
        **セルＣ３**：Googleドライブで、領収書だけを入れているフォルダを開いた画面のURLをコピーして、貼り付けます
        
        **セルＣ４**：ＤｉｆｙのＡＰＩキーを貼り付けます
        
        **セルＣ５**：ＤｉｆｙのユーザーＩＤを貼り付けます
        
        動画：
        
    - [ ]  ＳＴＥＰ４：ｕｒｌｓシートの「**Googleドライブから情報取得**」ボタンをクリックして、処理対象のリストを作成します。
        
        ここで、承認を求められますので、承認します。
        
    - [ ]  ＳＴＥＰ５：ｒｅｓｕｌｔシートの「スクリプト実行」ボタンをクリックして、処理を実行します。
        
        概ね１０件につき１分程度かかります。
        
        処理に６分以上かかるとタイムアウトエラーになるので、一度に処理するのは５０件程度が限界です。
        
    - [ ]  ＳＴＥＰ６：実行方法を変更してみます。
        
        可能な人だけ実行してください。
        
        スプレッドシートの上部メニューの「拡張機能」をクリックし、「Apps Script」をクリックします。
        
        スクリプトエディタが開くので、画面上部中央より少し右の「実行ログ」の左側の▼をクリックして、mainを見つけてクリックします。一番下にあるのでスクロールします。
        
        以下のようになったら、「実行」ボタンをクリックします。
        
        ![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/94739130-ba6a-488c-829a-2fbe2e8866b5/1a262e59-48bc-402c-87f7-bf73a26f0777/image.png)
        
        この実行方法ならエラーが出た時に詳細に原因がわかります。
        
    - [ ]  ＳＴＥＰ７：上記ＳＴＥＰ３のセルＣ３を入力したGoogleドライブの画面に、領収書ファイルをいくつかアップロードします。アップロード後、ＳＴＥＰ４とＳＴＥＰ５を実行してください。領収書の内容がｒｅｓｕｌｔシートに表示されます。Googleドライブにアップロードした分の領収書を処理します。
    

*🚀 準備完了です！*
